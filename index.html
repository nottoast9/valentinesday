    <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For Anya ðŸ’—</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- GLOBAL VARIABLES & RESET --- */
        :root {
            --primary-pink: #ffd1dc;
            --soft-pink: #ffeef2;
            --deep-rose: #e06c88;
            --lavender: #e6e6fa;
            --cream: #fffdd0;
            --text-dark: #4a4a4a;
            --text-light: #757575;
            --white: #ffffff;
            --shadow: 0 10px 30px rgba(224, 108, 136, 0.15);
            --transition: all 0.5s cubic-bezier(0.25, 1, 0.5, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, var(--soft-pink) 0%, var(--lavender) 100%);
            color: var(--text-dark);
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
        }

        /* --- BACKGROUND ANIMATION (HEARTS) --- */
        .bg-hearts {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .heart-particle {
            position: absolute;
            color: rgba(224, 108, 136, 0.3);
            animation: floatUp linear infinite;
            bottom: -50px;
        }

        @keyframes floatUp {
            0% { transform: translateY(0) rotate(0deg); opacity: 0; }
            10% { opacity: 0.5; }
            90% { opacity: 0.5; }
            100% { transform: translateY(-110vh) rotate(360deg); opacity: 0; }
        }

        /* --- UI ELEMENTS --- */
        button {
            cursor: pointer;
            font-family: 'Nunito', sans-serif;
            border: none;
            outline: none;
            transition: var(--transition);
        }

        .btn-primary {
            background-color: var(--deep-rose);
            color: var(--white);
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(224, 108, 136, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(224, 108, 136, 0.6);
            background-color: #d15a72;
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--deep-rose);
            color: var(--deep-rose);
            padding: 8px 20px;
            border-radius: 50px;
            font-weight: 600;
        }

        .btn-outline:hover {
            background: var(--deep-rose);
            color: var(--white);
        }

        /* --- NAVIGATION --- */
        header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
            /* Initially allow clicks to pass through, but we will hide it completely via the .locked class */
            pointer-events: none;
        }

        /* FIX: Hide header completely when locked */
        header.locked {
            display: none;
        }
        
        /* When unlocked, allow interaction with buttons */
        header:not(.locked) {
            pointer-events: auto;
        }

        .music-toggle {
            pointer-events: auto;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--deep-rose);
            font-size: 1.2rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }

        .menu-toggle {
            pointer-events: auto;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--deep-rose);
            font-size: 1.2rem;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }

        .nav-menu {
            position: fixed;
            top: 0;
            right: -100%;
            width: 80%;
            max-width: 300px;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            z-index: 101;
            padding: 80px 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            transition: right 0.4s ease;
            box-shadow: -5px 0 20px rgba(0,0,0,0.05);
        }

        .nav-menu.active {
            right: 0;
        }

        .nav-item {
            text-decoration: none;
            color: var(--text-dark);
            font-size: 1.1rem;
            padding: 10px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            opacity: 0.6;
            cursor: pointer;
            transition: 0.3s;
        }

        .nav-item:hover, .nav-item.active {
            opacity: 1;
            color: var(--deep-rose);
            padding-left: 15px;
        }

        .close-menu {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 1.5rem;
            color: var(--text-dark);
            cursor: pointer;
        }

        /* --- PAGE STRUCTURE --- */
        main {
            position: relative;
            z-index: 10;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 80px 20px;
        }

        .page {
            display: none; /* Hidden by default */
            width: 100%;
            max-width: 800px;
            text-align: center;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease, transform 0.6s ease;
        }

        .page.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        .page-content {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 20px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255,255,255,0.8);
        }

        h1, h2, h3 {
            font-family: 'Playfair Display', serif;
            color: var(--deep-rose);
            margin-bottom: 1rem;
        }

        p {
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--text-dark);
            margin-bottom: 20px;
        }

        /* --- PAGE 1: LOCK SCREEN --- */
        #page-lock .page-content {
            background: var(--white);
            max-width: 400px;
        }

        .lock-icon {
            font-size: 3rem;
            color: var(--deep-rose);
            margin-bottom: 20px;
            animation: pulse 2s infinite;
        }

        .password-input {
            width: 100%;
            padding: 15px;
            margin: 20px 0;
            border: 2px solid #eee;
            border-radius: 10px;
            text-align: center;
            font-size: 1.2rem;
            outline: none;
            transition: 0.3s;
        }

        .password-input:focus {
            border-color: var(--deep-rose);
        }

        .error-msg {
            color: var(--deep-rose);
            font-size: 0.9rem;
            margin-top: 10px;
            min-height: 20px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* --- PAGE 2: WELCOME --- */
        .greeting-anim {
            opacity: 0;
            animation: fadeInZoom 1.5s forwards;
        }
        
        @keyframes fadeInZoom {
            0% { opacity: 0; transform: scale(0.9); }
            100% { opacity: 1; transform: scale(1); }
        }

        /* --- PAGE 3: LETTERS --- */
        .letters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .letter-card {
            background: var(--white);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            cursor: pointer;
            transition: var(--transition);
            border: 1px solid transparent;
        }

        .letter-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-pink);
            box-shadow: var(--shadow);
        }

        .letter-card i {
            font-size: 2rem;
            color: var(--deep-rose);
            margin-bottom: 15px;
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 200;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            backdrop-filter: blur(5px);
        }

        .modal.open {
            opacity: 1;
            pointer-events: auto;
        }

        .modal-content {
            background: var(--white);
            width: 90%;
            max-width: 600px;
            padding: 40px;
            border-radius: 20px;
            position: relative;
            transform: translateY(20px);
            transition: transform 0.3s;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal.open .modal-content {
            transform: translateY(0);
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 1.5rem;
            color: var(--text-light);
            cursor: pointer;
        }

        /* Audio Section */
        .audio-section {
            margin-top: 40px;
            border-top: 2px dashed #eee;
            padding-top: 30px;
        }

        .audio-player-custom {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 10px 0;
            border: 1px solid #eee;
        }

        .play-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--deep-rose);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }

        .waveform {
            flex-grow: 1;
            height: 30px;
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .bar {
            width: 3px;
            background: #ccc;
            height: 10px;
            border-radius: 2px;
            transition: 0.2s;
        }

        .playing .bar {
            background: var(--deep-rose);
            animation: wave 1s infinite ease-in-out;
        }

        @keyframes wave {
            0%, 100% { height: 10px; }
            50% { height: 25px; }
        }

        /* --- PAGE 4: GALLERY --- */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .gallery-item {
            position: relative;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            cursor: pointer;
            height: 300px;
        }

        .gallery-item img, .gallery-item video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s;
        }

        .gallery-item:hover img, .gallery-item:hover video {
            transform: scale(1.1);
        }

        .gallery-caption {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(255,255,255,0.9);
            padding: 10px;
            font-family: 'Playfair Display', serif;
            color: var(--deep-rose);
            transform: translateY(100%);
            transition: transform 0.3s;
        }

        .gallery-item:hover .gallery-caption {
            transform: translateY(0);
        }

        /* --- PAGE 5: PUZZLE --- */
        .quiz-container {
            max-width: 500px;
            margin: 0 auto;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: #eee;
            border-radius: 10px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--deep-rose);
            width: 0%;
            transition: width 0.5s ease;
        }

        .question-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: var(--shadow);
            display: none; /* Managed by JS */
        }

        .question-card.active {
            display: block;
            animation: fadeInZoom 0.4s ease;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }

        .option-btn {
            background: #f8f8f8;
            padding: 12px;
            border-radius: 8px;
            text-align: left;
            transition: 0.2s;
        }

        .option-btn:hover {
            background: var(--soft-pink);
            color: var(--deep-rose);
        }

        /* --- PAGE 6: FINAL LETTER --- */
        .typing-container {
            font-family: 'Playfair Display', serif;
            font-size: 1.2rem;
            line-height: 2;
            text-align: left;
            white-space: pre-wrap;
            min-height: 300px;
        }

        .cursor {
            display: inline-block;
            width: 2px;
            height: 1.2em;
            background: var(--deep-rose);
            animation: blink 0.7s infinite;
            vertical-align: middle;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        .final-voice-btn {
            margin-top: 30px;
            animation: pulse 2s infinite;
            display: none; /* Hidden until typing done */
        }

        /* --- TOAST NOTIFICATIONS --- */
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--white);
            padding: 15px 25px;
            border-radius: 50px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s, transform 0.3s;
        }

        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(-10px);
        }

        /* Responsive */
        @media (max-width: 600px) {
            .page-content { padding: 25px; }
            h1 { font-size: 1.8rem; }
            p { font-size: 1rem; }
        }
    </style>
</head>
<body>

    <!-- Background Hearts -->
    <div class="bg-hearts" id="heart-container"></div>

    <!-- Header (Initially Locked/Hidden) -->
    <header id="main-header" class="locked">
        <div class="music-toggle" id="music-toggle">
            <i class="fas fa-volume-mute"></i>
        </div>
        <div class="menu-toggle" id="menu-toggle">
            <i class="fas fa-bars"></i>
        </div>
    </header>

    <!-- Navigation Menu -->
    <nav class="nav-menu" id="nav-menu">
        <div class="close-menu" id="close-menu">&times;</div>
        <a class="nav-item" onclick="navigateTo('page-welcome')">Home</a>
        <a class="nav-item" onclick="navigateTo('page-letters')">Letters</a>
        <a class="nav-item" onclick="navigateTo('page-gallery')">Gallery</a>
        <a class="nav-item" onclick="navigateTo('page-quiz')">Puzzle</a>
        <a class="nav-item" onclick="navigateTo('page-final')">Valentine Letter</a>
    </nav>

    <!-- Main Content -->
    <main>
        
        <!-- PAGE 1: PASSWORD ENTRY -->
        <section id="page-lock" class="page active">
            <div class="page-content">
                <div class="lock-icon">
                    <i class="fas fa-heart"></i>
                </div>
                <h2>For Kanya ðŸ’—</h2>
                <p>Please enter the password to continue.</p>
                <input type="password" id="lock-password" class="password-input" placeholder="Password...">
                <button class="btn-primary" onclick="checkMainPassword()">Unlock</button>
                <div class="error-msg" id="lock-error"></div>
            </div>
        </section>

        <!-- PAGE 2: WELCOME -->
        <section id="page-welcome" class="page">
            <div class="page-content">
                <div class="greeting-anim">
                    <h1>Hi Kanya ðŸ’—</h1>
                    <h2>Welcome to something I made just for you.</h2>
                    <p>Even though weâ€™re far apart, this is my way of being close to you.</p>
                </div>
                <br>
                <button class="btn-primary" onclick="navigateTo('page-letters')">Next <i class="fas fa-arrow-right"></i></button>
            </div>
        </section>

        <!-- PAGE 3: LETTERS -->
        <section id="page-letters" class="page">
            <div class="page-content">
                <h2>Letters for You</h2>
                <p>Click a letter to read it.</p>
                
                <div class="letters-grid">
                    <div class="letter-card" onclick="openLetter('lonely')">
                        <i class="fas fa-cloud-moon"></i>
                        <h3>When you feel lonely</h3>
                    </div>
                    <div class="letter-card" onclick="openLetter('miss')">
                        <i class="fas fa-wind"></i>
                        <h3>When you miss me</h3>
                    </div>
                    <div class="letter-card" onclick="openLetter('us')">
                        <i class="fas fa-infinity"></i>
                        <h3>Reminder of us</h3>
                    </div>
                </div>

                <div class="audio-section">
                    <h3><i class="fas fa-headphones"></i> Voice Notes</h3>
                    
                    <div class="audio-player-custom">
                        <div class="play-btn" onclick="toggleAudio(1)"><i class="fas fa-play" id="play-icon-1"></i></div>
                        <div class="waveform" id="wave-1">
                            <div class="bar"></div><div class="bar"></div><div class="bar"></div>
                            <div class="bar"></div><div class="bar"></div><div class="bar"></div>
                            <div class="bar"></div><div class="bar"></div><div class="bar"></div>
                            <div class="bar"></div><div class="bar"></div><div class="bar"></div>
                        </div>
                        <span style="font-size:0.8rem; color:#888;">A message from me</span>
                    </div>

                    <div class="audio-player-custom">
                        <div class="play-btn" onclick="toggleAudio(2)"><i class="fas fa-play" id="play-icon-2"></i></div>
                        <div class="waveform" id="wave-2">
                            <div class="bar"></div><div class="bar"></div><div class="bar"></div>
                            <div class="bar"></div><div class="bar"></div><div class="bar"></div>
                            <div class="bar"></div><div class="bar"></div><div class="bar"></div>
                            <div class="bar"></div><div class="bar"></div><div class="bar"></div>
                        </div>
                        <span style="font-size:0.8rem; color:#888;">Close your eyes & listen</span>
                    </div>
                </div>

                <br><br>
                <button class="btn-primary" onclick="navigateTo('page-gallery')">Next <i class="fas fa-arrow-right"></i></button>
            </div>
        </section>

        <!-- PAGE 4: GALLERY -->
        <section id="page-gallery" class="page">
            <div class="page-content">
                <h2>Moments I Treasure</h2>
                <div class="gallery-grid">
                    <!-- Video 1 -->
                    <div class="gallery-item">
                         <video controls poster="vid-1-thumbnail.jpg">
                            <source src="vid-1.mp4" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                        <div class="gallery-caption">Favorite Video #1</div>
                    </div>
                    <!-- Video 2 -->
                    <div class="gallery-item">
                        <video controls poster="vid-2-thumbnail.jpg">
                            <source src="vid-2.mp4" type="video/mp4">
                        </video>
                        <div class="gallery-caption">Favorite Video #2</div>
                    </div>
                    <!-- Picture -->
                    <div class="gallery-item">
                        <img src="pic.jpeg" alt="Favorite Picture">
                        <div class="gallery-caption">My Favorite Picture of You</div>
                </div>
                </div>
                <button class="btn-primary" onclick="navigateTo('page-quiz')">Next <i class="fas fa-arrow-right"></i></button>
            </div>
        </section>

        <!-- PAGE 5: PUZZLE -->
        <section id="page-quiz" class="page">
            <div class="page-content">
                <h2>How well do you know us?</h2>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                
                <div class="quiz-container" id="quiz-container">
                    <!-- Questions injected by JS -->
                </div>
                
                <div id="quiz-success" style="display:none; text-align:center;">
                    <i class="fas fa-heart" style="font-size:3rem; color:var(--deep-rose); margin-bottom:20px;"></i>
                    <h2>You did it, Anya! ðŸ’—</h2>
                    <p>You know us perfectly.</p>
                    <p style="background: #f0f0f0; padding: 15px; border-radius: 10px; display:inline-block; font-weight:bold; color:var(--deep-rose);">
                        Final Password: valentine2026
                    </p>
                    <br><br>
                    <button class="btn-primary" onclick="navigateTo('page-final')">Read My Letter <i class="fas fa-lock"></i></button>
                </div>
            </div>
        </section>

        <!-- PAGE 6: FINAL LETTER -->
        <section id="page-final" class="page">
            <div class="page-content">
                <h2 style="text-align: center;">My Valentine Letter</h2>
                
                <!-- Password Protection inside this page -->
                <div id="final-lock" style="text-align: center;">
                    <p>This letter is protected.</p>
                    <input type="password" id="final-password-input" class="password-input" placeholder="Enter the code...">
                    <button class="btn-outline" onclick="checkFinalPassword()">Open</button>
                    <div class="error-msg" id="final-lock-error"></div>
                </div>

                <div id="final-letter-content" style="display: none;">
                    <div class="typing-container">
                        <span id="typewriter-text"></span><span class="cursor"></span>
                    </div>

                    <button class="btn-primary final-voice-btn" id="final-voice-btn" onclick="playFinalVoice()">
                        <i class="fas fa-play"></i> Play this after reading ðŸ’—
                    </button>
                </div>
            </div>
        </section>

    </main>

    <!-- Letter Modal -->
    <div class="modal" id="letter-modal">
        <div class="modal-content">
            <div class="close-modal" onclick="closeModal()">&times;</div>
            <h3 id="modal-title" style="text-align:center; margin-bottom:20px;"></h3>
            <div id="modal-body" style="font-family:'Playfair Display', serif; line-height:1.8; color: #555;"></div>
            <p style="text-align:right; margin-top:30px; font-style:italic; color:var(--deep-rose);">â€” Always yours, Imad ðŸ’—</p>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <i class="fas fa-info-circle" style="color:var(--deep-rose);"></i>
        <span id="toast-msg">Notification</span>
    </div>

    <!-- Hidden Audio Elements -->
    <audio id="bg-music" loop>
        <source src="https://cdn.pixabay.com/download/audio/2022/10/18/audio_31c2730e64.mp3" type="audio/mp3">
    </audio>
    
    <audio id="voice-note-1">
        <source src="/voice-note-1.mp3" type="audio/mpeg">
    </audio>
    <audio id="voice-note-2">
        <source src="/voice-note-2.mp3" type="audio/mpeg">
    </audio>
    <audio id="final-voice-rec">
        <source src="/final-voice-rec.mp3" type="audio/mpeg">
    </audio>

    <script>
        /* --- DATA & CONTENT --- */
        const letterContent = {
            lonely: "My dearest Anya,<br><br>I know sometimes the distance feels heavy. When you're lonely, always remember that my heart is right there beside you. You are never truly alone because we are connected by something stronger than miles.",
            miss: "Anya,<br><br>When you miss me, know that I am missing you ten times more. Every song I hear, every beautiful sunset I see, I wish you were here. But this distance is just temporary. We are building a story that is worth the wait.",
            us: "To us,<br><br>Never forget how special we are. What we have is rare. It survives time zones, screens, and silence. Itâ€™s built on laughter, trust, and a deep love that keeps growing. I chose you, and I will keep choosing you every single day. I love you soo much, never forget that"
        };

        const questions = [
            { q: "Where did we first 'meet' online?", options: ["Telegram", "Instagram", "A Game", "Twitter"], correct: 0 }, // Example answer
            { q: "What is my nickname for you?", options: ["Baby", "Anya", "Sweetheart", "Princess"], correct: 1 },
            { q: "What is my favorite color?", options: ["Blue", "Black", "Red", "white"], correct: 3 }, // Placeholder
            { q: "When is my birthday?", options: ["Nov 8", "March 16", "Nov 4", "June 23"], correct: 2 },
            { q: "What is one thing I promised you?", options: ["To leave", "To never give up on us", "To buy a car", "To change"], correct: 1 },
            { q: "When is our anniversary", options: ["sept 23", "jan 13", "jan 23", "nov 4"], correct: 2 }, // Placeholder
            { q: "What was our first phone call about?", options: ["New years", "just boredom", "birthday", "No idea"], correct: 0 },
            { q: "What is our goal?", options: ["To be rich", "To close the distance", "To travel alone", "Nothing"], correct: 1 },
            { q: "Who loves you more?", options: ["No one", "Me (Imad)", "My cat", "My mom"], correct: 1 },
            { q: "When is Valentine's Day?", options: ["March 14", "Feb 14", "Dec 25", "Nov 11"], correct: 1 }
        ];

        const finalLetterText = `My Dearest Kanya,

Happy Valentine's Day.

I wanted to write this to you because sometimes words get lost in text messages or short calls. I want you to have something permanent, something you can come back to whenever you need to.

Even though we haven't met in person yet, you have changed my life in ways I can't fully explain. Long distance is hard. Itâ€™s lonely at night, and itâ€™s frustrating when I can't hold your hand. But every single day, I wake up knowing that you are worth the wait.

You are mine. The person who makes me smile just by existing. I chose you, and I will keep choosing you over and over again, no matter how many miles stand between us.

I imagine the day we finally meet. I imagine the first hug, the first look in your eyes. Until then, this website is my hug to you.

I love you more than any words can express.

Forever yours,
Imad ðŸ’—`;

        /* --- STATE --- */
        let currentQuestion = 0;
        let isMusicPlaying = false;
        let unlockedFinal = false;

        /* --- INITIALIZATION --- */
        document.addEventListener('DOMContentLoaded', () => {
            createHearts();
            renderQuestion();
            setupMenu();
        });

        /* --- NAVIGATION & UI --- */
        function navigateTo(pageId) {
            // Check access for Final Page
            if(pageId === 'page-final' && !unlockedFinal) {
                // Allow navigation to page, but page content is locked
            }

            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
                setTimeout(() => {
                    if(!page.classList.contains('active')) page.style.display = 'none';
                }, 500);
            });

            // Show target page
            const target = document.getElementById(pageId);
            target.style.display = 'block';
            // Small delay to allow display:block to render before adding opacity class
            setTimeout(() => {
                target.classList.add('active');
            }, 10);

            closeMenu();
            window.scrollTo(0,0);
        }

        function setupMenu() {
            const toggle = document.getElementById('menu-toggle');
            const close = document.getElementById('close-menu');
            const menu = document.getElementById('nav-menu');

            toggle.addEventListener('click', () => menu.classList.add('active'));
            close.addEventListener('click', closeMenu);
            
            // Close menu if clicking outside
            document.addEventListener('click', (e) => {
                if (!menu.contains(e.target) && !toggle.contains(e.target) && menu.classList.contains('active')) {
                    closeMenu();
                }
            });
        }

        function closeMenu() {
            document.getElementById('nav-menu').classList.remove('active');
        }

        function showToast(msg) {
            const toast = document.getElementById('toast');
            document.getElementById('toast-msg').innerText = msg;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        /* --- PAGE 1: LOCK SCREEN --- */
        function checkMainPassword() {
            const input = document.getElementById('lock-password').value.toLowerCase().trim();
            const error = document.getElementById('lock-error');
            
            if (input === 'ilovekanya') {
                // FIX: Remove the 'locked' class from the header to reveal menu and music
                document.getElementById('main-header').classList.remove('locked');
                
                navigateTo('page-welcome');
            } else {
                error.innerText = "Hmmâ€¦ that doesnâ€™t feel quite right ðŸ’— Try again.";
                error.style.opacity = 1;
                document.getElementById('lock-password').value = '';
                
                // Shake animation
                const content = document.querySelector('#page-lock .page-content');
                content.style.animation = 'none';
                setTimeout(() => content.style.animation = 'shake 0.5s', 10);
            }
        }

        /* --- PAGE 3: LETTERS & AUDIO --- */
        function openLetter(type) {
            document.getElementById('modal-title').innerText = type === 'lonely' ? 'When you feel lonely' : type === 'miss' ? 'When you miss me' : 'Reminder of us';
            document.getElementById('modal-body').innerHTML = letterContent[type];
            document.getElementById('letter-modal').classList.add('open');
        }

        function closeModal() {
            document.getElementById('letter-modal').classList.remove('open');
        }

        function toggleAudio(id) {
            const audio = document.getElementById(id === 1 ? 'voice-note-1' : 'voice-note-2');
            const wave = document.getElementById(id === 1 ? 'wave-1' : 'wave-2');
            const icon = document.getElementById(id === 1 ? 'play-icon-1' : 'play-icon-2');

            // Check if source is empty (placeholder)
            if(!audio.currentSrc || audio.currentSrc.includes(window.location.href)) {
                showToast("Audio file not uploaded yet!");
                return;
            }

            if(audio.paused) {
                audio.play();
                icon.classList.remove('fa-play');
                icon.classList.add('fa-pause');
                wave.classList.add('playing');
            } else {
                audio.pause();
                icon.classList.remove('fa-pause');
                icon.classList.add('fa-play');
                wave.classList.remove('playing');
            }
        }

        /* --- PAGE 5: QUIZ --- */
        function renderQuestion() {
            const container = document.getElementById('quiz-container');
            container.innerHTML = '';
            
            if (currentQuestion >= questions.length) {
                document.getElementById('quiz-container').style.display = 'none';
                document.getElementById('quiz-success').style.display = 'block';
                return;
            }

            const q = questions[currentQuestion];
            const card = document.createElement('div');
            card.className = 'question-card active';
            card.innerHTML = `
                <h3>${q.q}</h3>
                <div class="options">
                    ${q.options.map((opt, i) => `<button class="option-btn" onclick="checkAnswer(${i}, this)">${opt}</button>`).join('')}
                </div>
            `;
            container.appendChild(card);
            
            updateProgress();
        }

        function checkAnswer(selectedIndex, btnElement) {
            const q = questions[currentQuestion];
            if (selectedIndex === q.correct) {
                btnElement.style.background = '#d4edda';
                btnElement.style.color = '#155724';
                showToast("Correct! ðŸ’—");
                currentQuestion++;
                setTimeout(renderQuestion, 500);
            } else {
                btnElement.style.background = '#f8d7da';
                btnElement.style.color = '#721c24';
                showToast("Not quiteâ€¦ but I love you anyway ðŸ’• Try again.");
            }
        }

        function updateProgress() {
            const pct = (currentQuestion / questions.length) * 100;
            document.getElementById('progress-fill').style.width = pct + '%';
        }

        /* --- PAGE 6: FINAL LETTER --- */
        function checkFinalPassword() {
            const input = document.getElementById('final-password-input').value.toLowerCase().trim();
            const error = document.getElementById('final-lock-error');

            if (input === 'valentine2026') {
                unlockedFinal = true;
                document.getElementById('final-lock').style.display = 'none';
                document.getElementById('final-letter-content').style.display = 'block';
                startTypewriter();
            } else {
                error.innerText = "Not the magic word yet, my love ðŸ’—";
                error.style.opacity = 1;
            }
        }

        function startTypewriter() {
            const el = document.getElementById('typewriter-text');
            let i = 0;
            const speed = 50; // ms

            function type() {
                if (i < finalLetterText.length) {
                    el.innerHTML += finalLetterText.charAt(i);
                    i++;
                    setTimeout(type, speed);
                } else {
                    document.getElementById('final-voice-btn').style.display = 'inline-block';
                }
            }
            type();
        }

        function playFinalVoice() {
            const audio = document.getElementById('final-voice-rec');
            if(!audio.currentSrc || audio.currentSrc.includes(window.location.href)) {
                showToast("Final voice note not uploaded yet!");
                return;
            }
            audio.play();
        }

        /* --- BACKGROUND MUSIC --- */
        const musicToggle = document.getElementById('music-toggle');
        const bgMusic = document.getElementById('bg-music');

        musicToggle.addEventListener('click', () => {
            if (isMusicPlaying) {
                bgMusic.pause();
                musicToggle.innerHTML = '<i class="fas fa-volume-mute"></i>';
            } else {
                bgMusic.play().then(() => {
                    musicToggle.innerHTML = '<i class="fas fa-music"></i>';
                }).catch(e => {
                    console.log("Autoplay blocked, interaction needed first");
                });
            }
            isMusicPlaying = !isMusicPlaying;
        });

        /* --- BACKGROUND ANIMATION SYSTEM --- */
        function createHearts() {
            const container = document.getElementById('heart-container');
            const heartCount = 20; // Max hearts

            for (let i = 0; i < heartCount; i++) {
                const heart = document.createElement('div');
                heart.classList.add('heart-particle');
                heart.innerHTML = '<i class="fas fa-heart"></i>';
                
                // Randomize
                const size = Math.random() * 15 + 10;
                heart.style.fontSize = `${size}px`;
                heart.style.left = `${Math.random() * 100}%`;
                heart.style.animationDuration = `${Math.random() * 5 + 5}s`;
                heart.style.animationDelay = `${Math.random() * 5}s`;
                
                container.appendChild(heart);
            }
        }

        /* --- CSS SHAKE ANIMATION --- */
        const styleSheet = document.createElement("style");
        styleSheet.innerText = `
            @keyframes shake {
                0% { transform: translateX(0); }
                25% { transform: translateX(-10px); }
                50% { transform: translateX(10px); }
                75% { transform: translateX(-10px); }
                100% { transform: translateX(0); }
            }
        `;
        document.head.appendChild(styleSheet);

    </script>
</body>

</html>

